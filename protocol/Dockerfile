FROM node:16.15-alpine

ARG INFURA_WS_URL
ARG PRIVATE_KEY
ARG POSTS_CONTRACT_ADDRESS
ARG FEES_COLLECTOR_ADDRESS

ENV INFURA_WS_URL=${INFURA_WS_URL}
ENV PRIVATE_KEY=${PRIVATE_KEY}
ENV POSTS_CONTRACT_ADDRESS=${POSTS_CONTRACT_ADDRESS}
ENV FEES_COLLECTOR_ADDRESS=${FEES_COLLECTOR_ADDRESS}

RUN mkdir code

COPY . /code

RUN npm install --global yarn

WORKDIR /code

RUN yarn

RUN yarn bot:posts:pm2
